<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Master Pro 2025 - Educational Game</title>
    <!-- 
        –≠—Ç–æ—Ç –∫–æ–¥ –∏–º–∏—Ç–∏—Ä—É–µ—Ç —Å–ª–æ–∂–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É Python-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
        –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–ª–æ–≤ –∏ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ –º–∞—Å—Å–∏–≤ –¥–∞–Ω–Ω—ã—Ö (Data Set).
    -->
    <style>
        :root {
            --primary: #4a90e2;
            --secondary: #2ecc71;
            --danger: #e74c3c;
            --dark: #2c3e50;
            --light: #ecf0f1;
            --gold: #f1c40f;
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --text-color: #333;
        }

        body.dark-mode {
            --bg-color: #1a1a2e;
            --card-bg: #16213e;
            --text-color: #e94560;
            --light: #0f3460;
        }

        body.neon-mode {
            --bg-color: #000;
            --card-bg: #111;
            --text-color: #39ff14;
            --primary: #ff00ff;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            transition: all 0.5s ease;
        }

        header {
            width: 100%;
            padding: 20px;
            background: var(--dark);
            color: white;
            display: flex;
            justify-content: space-around;
            align-items: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        .container {
            max-width: 800px;
            width: 90%;
            margin-top: 40px;
            background: var(--card-bg);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stats-bar {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 30px;
        }

        .stat-item {
            background: var(--light);
            padding: 10px;
            border-radius: 8px;
            font-weight: bold;
        }

        .word-display {
            font-size: 3rem;
            margin: 30px 0;
            letter-spacing: 8px;
            min-height: 80px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-bottom: 3px dashed var(--primary);
            text-transform: uppercase;
        }

        .grammar-display {
            font-size: 1.5rem;
            margin: 30px 0;
            line-height: 1.6;
        }

        .input-group {
            margin: 20px 0;
        }

        input[type="text"] {
            width: 70%;
            padding: 15px;
            font-size: 1.2rem;
            border: 2px solid #ddd;
            border-radius: 10px;
            outline: none;
            transition: border 0.3s;
        }

        input[type="text"]:focus {
            border-color: var(--primary);
        }

        .btn {
            padding: 15px 30px;
            font-size: 1.1rem;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s, background 0.3s;
            margin: 5px;
        }

        .btn:active { transform: scale(0.95); }
        .btn-check { background: var(--secondary); color: white; }
        .btn-hint { background: var(--gold); color: white; }
        .btn-skip { background: #95a5a6; color: white; }

        .shop-container {
            margin-top: 40px;
            border-top: 2px solid #eee;
            padding-top: 20px;
        }

        .skins-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .skin-card {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
        }

        .skin-card:hover { background: var(--light); }
        .locked { filter: grayscale(1); opacity: 0.7; }

        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 5px;
            color: white;
            display: none;
            animation: slideIn 0.3s forwards;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        #level-progress {
            width: 100%;
            height: 10px;
            background: #eee;
            border-radius: 5px;
            margin-top: 5px;
            overflow: hidden;
        }

        #level-fill {
            width: 0%;
            height: 100%;
            background: var(--primary);
            transition: width 0.3s;
        }
    </style>
</head>
<body>

<header>
    <h2>English Master 2025</h2>
    <div>–£—Ä–æ–≤–µ–Ω—å: <span id="lvl-display">1</span></div>
    <div id="level-progress-cont" style="width: 200px;">
        –ü—Ä–æ–≥—Ä–µ—Å—Å XP:
        <div id="level-progress"><div id="level-fill"></div></div>
    </div>
</header>

<div class="container">
    <div class="stats-bar">
        <div class="stat-item">ü™ô –ú–æ–Ω–µ—Ç—ã: <span id="coins-display">0</span></div>
        <div class="stat-item">üî• –°–µ—Ä–∏—è: <span id="streak-display">0</span></div>
        <div class="stat-item">‚úÖ –í–µ—Ä–Ω–æ: <span id="correct-display">0</span></div>
        <div class="stat-item">üè∑ –¢–µ–º–∞: <span id="topic-display">-</span></div>
    </div>

    <div id="task-description">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞–Ω–∏—è...</div>
    
    <div id="game-area">
        <!-- –°—é–¥–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å–ª–æ–≤–æ –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ -->
        <div id="main-display" class="word-display">WORD</div>
    </div>

    <div class="input-group">
        <input type="text" id="user-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç –∑–¥–µ—Å—å..." autofocus>
    </div>

    <div class="btn-group">
        <button class="btn btn-check" id="check-btn">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å (Enter)</button>
        <button class="btn btn-hint" id="hint-btn">–ü–æ–¥—Å–∫–∞–∑–∫–∞ (-20 ü™ô)</button>
        <button class="btn btn-skip" id="skip-btn">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
    </div>

    <div class="shop-container">
        <h3>üõí –ú–∞–≥–∞–∑–∏–Ω —Å–∫–∏–Ω–æ–≤ –∏ —É–ª—É—á—à–µ–Ω–∏–π</h3>
        <div class="skins-grid">
            <div class="skin-card" onclick="applySkin('default')">
                <b>Classic</b><br>–ë–µ—Å–ø–ª–∞—Ç–Ω–æ
            </div>
            <div class="skin-card" id="skin-dark" onclick="buySkin('dark', 150)">
                <b>Deep Dark</b><br>üí∞ 150
            </div>
            <div class="skin-card" id="skin-neon" onclick="buySkin('neon', 500)">
                <b>Cyber Neon</b><br>üí∞ 500
            </div>
        </div>
    </div>
</div>

<div id="toast" class="toast"></div>

<script>
/** 
 * –ö–û–†–ü–£–° –î–ê–ù–ù–´–• (DATABASE) 
 * –í —Ä–µ–∞–ª—å–Ω–æ–º Python –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —ç—Ç–æ –±—ã–ª –±—ã –æ—Ç–¥–µ–ª—å–Ω—ã–π JSON –∏–ª–∏ SQL —Ñ–∞–π–ª.
 */
const GAME_DATABASE = {
    topics: {
        "Jobs": [
            "accountant", "architect", "astronomer", "blacksmith", "carpenter", "dentist", "detective",
            "electrician", "engineer", "firefighter", "journalist", "librarian", "mechanic", "musician",
            "nurse", "optician", "pharmacist", "photographer", "pilot", "plumber", "politician",
            "programmer", "psychologist", "receptionist", "scientist", "surgeon", "translator", "veterinary"
        ],
        "Environment": [
            "atmosphere", "biodiversity", "conservation", "deforestation", "drought", "ecosystem",
            "emissions", "extinction", "fertilizer", "glacier", "greenhouse", "habitat", "hurricane",
            "landfill", "pollution", "radiation", "recycling", "renewable", "sustainability", "wildlife"
        ],
        "Tourism": [
            "accommodation", "adventure", "baggage", "booking", "brochure", "cathedral", "currency",
            "customs", "destination", "excursion", "guidebook", "itinerary", "landmark", "monument",
            "passport", "resort", "sightseeing", "souvenir", "suitcase", "tourist", "voyage"
        ],
        "Weather": [
            "blizzard", "breeze", "cloudy", "cyclone", "drizzle", "forecast", "freezing", "humidity",
            "lightning", "overcast", "rainbow", "scorching", "shivering", "thunderstorm", "tornado",
            "typhoon", "weather", "whirlwind"
        ],
        "Science": [
            "analysis", "bacteria", "cell", "chemical", "discovery", "experiment", "formula", "gravity",
            "hypothesis", "laboratory", "molecule", "nucleus", "organism", "particle", "quantum", "theory"
        ]
    },
    grammar: [
        { q: "I ___ (to be) a student.", a: "am", hint: "–§–æ—Ä–º–∞ –≥–ª–∞–≥–æ–ª–∞ to be –¥–ª—è 'I'" },
        { q: "She ___ (to go) to the gym every day.", a: "goes", hint: "Present Simple, 3-–µ –ª–∏—Ü–æ –µ–¥. —á–∏—Å–ª–æ" },
        { q: "We ___ (to watch) a great movie right now.", a: "are watching", hint: "Present Continuous" },
        { q: "Have you ever ___ (to visit) London?", a: "visited", hint: "Present Perfect (V3)" },
        { q: "This car is ___ (expensive) than mine.", a: "more expensive", hint: "–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–µ–ø–µ–Ω—å" },
        { q: "___ apple a day keeps the doctor away.", a: "an", hint: "–ê—Ä—Ç–∏–∫–ª—å –ø–µ—Ä–µ–¥ –≥–ª–∞—Å–Ω–æ–π" },
        { q: "If it rains, I ___ (to stay) at home.", a: "will stay", hint: "First Conditional" },
        { q: "They ___ (to build) this house in 1990.", a: "built", hint: "Past Simple" },
        { q: "He doesn't ___ (to like) coffee.", a: "like", hint: "–ü–æ—Å–ª–µ doesn't –≥–ª–∞–≥–æ–ª –±–µ–∑ –æ–∫–æ–Ω—á–∞–Ω–∏–π" },
        { q: "There ___ (to be) some milk in the fridge.", a: "is", hint: "Milk - –Ω–µ–∏—Å—á–∏—Å–ª—è–µ–º–æ–µ" }
    ]
};

/**
 * –ò–ì–†–û–í–ê–Ø –õ–û–ì–ò–ö–ê (ENGINE)
 */
class EnglishGame {
    constructor() {
        this.coins = parseInt(localStorage.getItem('eng_coins')) || 0;
        this.xp = parseInt(localStorage.getItem('eng_xp')) || 0;
        this.streak = 0;
        this.correctCount = 0;
        this.currentAnswer = "";
        this.currentMode = ""; // 'anagram' or 'grammar'
        this.unlockedSkins = JSON.parse(localStorage.getItem('eng_skins')) || ['default'];
        
        this.init();
    }

    init() {
        this.updateUI();
        this.nextQuestion();
        
        document.getElementById('check-btn').onclick = () => this.check();
        document.getElementById('hint-btn').onclick = () => this.getHint();
        document.getElementById('skip-btn').onclick = () => this.nextQuestion();
        document.getElementById('user-input').onkeypress = (e) => {
            if (e.key === 'Enter') this.check();
        };
    }

    nextQuestion() {
        const rand = Math.random();
        // 70% —Å–ª–æ–≤, 30% –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏
        if (rand > 0.3) {
            this.setupAnagram();
        } else {
            this.setupGrammar();
        }
        document.getElementById('user-input').value = "";
        document.getElementById('user-input').focus();
    }

    setupAnagram() {
        this.currentMode = "anagram";
        const topics = Object.keys(GAME_DATABASE.topics);
        const topic = topics[Math.floor(Math.random() * topics.length)];
        const words = GAME_DATABASE.topics[topic];
        const word = words[Math.floor(Math.random() * words.length)];
        
        this.currentAnswer = word;
        document.getElementById('topic-display').innerText = topic;
        document.getElementById('task-description').innerText = "–°–æ–±–µ—Ä–∏ —Å–ª–æ–≤–æ –∏–∑ –±—É–∫–≤:";
        
        const scrambled = this.scramble(word);
        const display = document.getElementById('main-display');
        display.className = "word-display";
        display.innerText = scrambled;
    }

    setupGrammar() {
        this.currentMode = "grammar";
        const task = GAME_DATABASE.grammar[Math.floor(Math.random() * GAME_DATABASE.grammar.length)];
        
        this.currentAnswer = task.a;
        this.currentHint = task.hint;
        
        document.getElementById('topic-display').innerText = "Grammar";
        document.getElementById('task-description').innerText = "–ó–∞–ø–æ–ª–Ω–∏ –ø—Ä–æ–ø—É—Å–∫:";
        
        const display = document.getElementById('main-display');
        display.className = "grammar-display";
        display.innerText = task.q;
    }

    scramble(word) {
        let a = word.split(""), n = a.length;
        for(let i = n - 1; i > 0; i--) {
            let j = Math.floor(Math.random() * (i + 1));
            let tmp = a[i]; a[i] = a[j]; a[j] = tmp;
        }
        let res = a.join("");
        return res === word ? this.scramble(word) : res;
    }

    check() {
        const userVal = document.getElementById('user-input').value.toLowerCase().trim();
        
        if (userVal === this.currentAnswer.toLowerCase()) {
            this.handleSuccess();
        } else {
            this.handleFailure();
        }
    }

    handleSuccess() {
        const reward = 15 + (this.streak * 2);
        const xpGain = 10;
        
        this.coins += reward;
        this.xp += xpGain;
        this.streak++;
        this.correctCount++;
        
        this.showToast(`‚úÖ –í–µ—Ä–Ω–æ! +${reward} ü™ô –∏ +${xpGain} XP`, "var(--secondary)");
        this.save();
        this.updateUI();
        
        // –ú–∞–ª–µ–Ω—å–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º –≤–æ–ø—Ä–æ—Å–æ–º
        setTimeout(() => this.nextQuestion(), 1000);
    }

    handleFailure() {
        this.streak = 0;
        this.showToast("‚ùå –û—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π –µ—â–µ —Ä–∞–∑!", "var(--danger)");
        this.updateUI();
        
        // –í–∏–∑—É–∞–ª—å–Ω–∞—è –≤—Å—Ç—Ä—è—Å–∫–∞
        const card = document.querySelector('.container');
        card.style.transform = "translateX(10px)";
        setTimeout(() => card.style.transform = "translateX(-10px)", 50);
        setTimeout(() => card.style.transform = "translateX(0)", 100);
    }

    getHint() {
        if (this.coins >= 20) {
            this.coins -= 20;
            if (this.currentMode === "anagram") {
                this.showToast(`–ü–æ–¥—Å–∫–∞–∑–∫–∞: –ø–µ—Ä–≤–∞—è –±—É–∫–≤–∞ "${this.currentAnswer[0].toUpperCase()}"`, "var(--gold)");
            } else {
                this.showToast(`–ü–æ–¥—Å–∫–∞–∑–∫–∞: ${this.currentHint}`, "var(--gold)");
            }
            this.updateUI();
            this.save();
        } else {
            this.showToast("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!", "var(--danger)");
        }
    }

    updateUI() {
        document.getElementById('coins-display').innerText = this.coins;
        document.getElementById('streak-display').innerText = this.streak;
        document.getElementById('correct-display').innerText = this.correctCount;
        
        const level = Math.floor(this.xp / 100) + 1;
        const currentLevelXp = this.xp % 100;
        
        document.getElementById('lvl-display').innerText = level;
        document.getElementById('level-fill').style.width = currentLevelXp + "%";

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–Ω–æ–ø–æ–∫ –º–∞–≥–∞–∑–∏–Ω–∞
        if (this.unlockedSkins.includes('dark')) document.getElementById('skin-dark').classList.remove('locked');
        else document.getElementById('skin-dark').classList.add('locked');
        
        if (this.unlockedSkins.includes('neon')) document.getElementById('skin-neon').classList.remove('locked');
        else document.getElementById('skin-neon').classList.add('locked');
    }

    showToast(text, color) {
        const t = document.getElementById('toast');
        t.innerText = text;
        t.style.backgroundColor = color;
        t.style.display = "block";
        setTimeout(() => t.style.display = "none", 2500);
    }

    save() {
        localStorage.setItem('eng_coins', this.coins);
        localStorage.setItem('eng_xp', this.xp);
        localStorage.setItem('eng_skins', JSON.stringify(this.unlockedSkins));
    }
}

// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–∞
const game = new EnglishGame();

function buySkin(name, price) {
    if (game.unlockedSkins.includes(name)) {
        applySkin(name);
        return;
    }

    if (game.coins >= price) {
        game.coins -= price;
        game.unlockedSkins.push(name);
        game.save();
        game.updateUI();
        applySkin(name);
        game.showToast("–°–∫–∏–Ω —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω!", "var(--secondary)");
    } else {
        game.showToast(`–ù—É–∂–Ω–æ –µ—â–µ ${price - game.coins} ü™ô`, "var(--danger)");
    }
}

function applySkin(mode) {
    document.body.className = "";
    if (mode !== 'default') {
        document.body.classList.add(mode + '-mode');
    }
}
</script>

</body>
</html>
